#!/usr/bin/env groovy
pipeline{

    agent { docker { image 'golang' } }

    stages{

        parallel{
            stage('TestSum'){
                steps{
                    sh 'go test -run TestSum'
                }
            }

            stage('TestHashToBcrypt'){
                steps{
                    sh 'go test -run TestHashToBcrypt'
                }
            }

            stage('TestRemoveNonNumeric'){
                steps{
                    sh 'go test -run TestRemoveNonNumeric'
                }
            }
        }

        stage('Build'){
            steps{
                sh 'go build main.go math.go -o app'
            }
        }

    }

    post {
        always {
            archiveArtifacts artifacts: 'app', onlyIfSuccessful: true
        }
    }
}